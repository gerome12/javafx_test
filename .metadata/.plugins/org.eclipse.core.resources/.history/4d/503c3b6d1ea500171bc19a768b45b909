package view;

import java.awt.Button;
import java.io.IOException;

import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.scene.Cursor;
import javafx.scene.Parent;
import javafx.scene.image.ImageView;
import javafx.scene.input.ClipboardContent;
import javafx.scene.input.DragEvent;
import javafx.scene.input.Dragboard;
import javafx.scene.input.MouseEvent;
import javafx.scene.input.TouchEvent;
import javafx.scene.input.TransferMode;
import javafx.scene.layout.AnchorPane;
import javafx.scene.layout.BorderPane;
import javafx.scene.paint.Color;
import javafx.scene.shape.Rectangle;
import javafx.scene.text.Text;
import javafx.stage.Stage;

public class vuePrincipaleController {

	@FXML private BorderPane border;

	@FXML
	private Text txtInfo;
	@FXML
	private Rectangle rect;
	@FXML
	private AnchorPane menu;

	@FXML
	private Rectangle rect2;
	@FXML
	private AnchorPane menu2;
	@FXML
	private Rectangle b4;

	private boolean stateMenu = true;


	@FXML
    public void initialize() {


		/************************************************************
		 *                        MENU 1                            *
		 ************************************************************/

		rect.setOnTouchPressed(new EventHandler<TouchEvent>() {
            @Override
            public void handle(TouchEvent event) {
            	//ouverture du menu
            	txtInfo.setText(event.getEventType().getName());
                event.consume();

	            menu.setVisible(! stateMenu);
            	stateMenu = ! stateMenu;
                rect.setFill(Color.BEIGE);
            }
        });

        rect.setOnTouchReleased(new EventHandler<TouchEvent>() {
            @Override
            public void handle(TouchEvent event) {
            	//fremeture du menu
            	txtInfo.setText(event.getEventType().getName());
                event.consume();
                rect.setFill(Color.DODGERBLUE);
            }
        });

    	/************************************************************
    	 *                        MENU 2                            *
    	 ************************************************************/

        rect2.setOnDragDetected(new EventHandler <MouseEvent>() {
	        public void handle(MouseEvent event) {
	            /* drag was detected, start drag-and-drop gesture*/
	            System.out.println(event.getEventType().getName());

	            /* allow any transfer mode */
	            Dragboard db = rect2.startDragAndDrop(TransferMode.LINK);

	            /* put a string on dragboard */
	            ClipboardContent content = new ClipboardContent();
	            content.putString("test");
	            db.setContent(content);

	            menu2.setCursor(Cursor.WAIT);
	            menu2.setVisible(true);
	            event.consume();
	        }
	    });

		rect2.setOnDragDone(new EventHandler <DragEvent>() {
	        public void handle(DragEvent event) {
	        	System.out.println(event.getEventType().getName());
	        	if(event.getTransferMode() == null)
	        		txtInfo.setText("aucun outil sélectionné");
	        	menu2.setVisible(false);

	            event.consume();
	        }
	    });




		b4.setOnDragOver(new EventHandler <DragEvent>() {
	        public void handle(DragEvent event) {
	            /* data is dragged over the target */
	            System.out.println(event.getEventType().getName());
	            event.acceptTransferModes(TransferMode.LINK);
	            event.consume();
	        }
	    });

		b4.setOnDragEntered(new EventHandler <DragEvent>() {
	        public void handle(DragEvent event) {
	            /* the drag-and-drop gesture entered the target */
	            System.out.println("onDragEntered");
	            b4.setFill(Color.RED);
	            event.consume();
	        }
	    });

		b4.setOnDragExited(new EventHandler <DragEvent>() {
	        public void handle(DragEvent event) {
	            /* mouse moved away, remove the graphical cues */
	        	b4.setFill(Color.BLACK);
	            event.consume();
	        }
	    });

		b4.setOnDragDropped(new EventHandler <DragEvent>() {
	        public void handle(DragEvent event) {
	            /* data dropped */
	            System.out.println("onDragDropped");

	            /* let the source know whether the string was successfully
	             * transferred and used */
	            txtInfo.setText("BOUTON_4");
	            event.setDropCompleted(true);

	            event.consume();
	        }
	    });

	}

    @FXML
    private void handleAction(ActionEvent event) {

        txtInfo.setText("SELECTED TOOL : " + event.getSource().toString().split("'")[1]);
        stateMenu = false;
        menu.setVisible(false);
    }
}
